<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
  th:replace="~{_layout :: html(~{::title}, ~{::section}, ~{::pageCss}, ~{::pageScript})}">

<!--
    formulario de lista
    permite crear nuevas listas o editar listas existentes
-->

<head>
  <!-- título dinámico según acción -->
  <title th:text="${lista.id == null ? 'Crear Nueva Lista' : 'Editar Lista'} + ' - WatchList'">Crear Nueva Lista -
    WatchList</title>
  <th:block th:fragment="pageCss">
    <link rel="stylesheet" th:href="@{/css/forms.css}" />
  </th:block>
</head>

<body>
  <!-- contenido principal -->
  <section th:fragment="section">
    <!-- título del formulario -->
    <h1 th:text="${lista.id == null ? 'Crear Nueva Lista' : 'Editar Lista'}">Crear Nueva Lista</h1>

    <!-- mensaje de error general -->
    <div th:if="${error}" class="alert alert-danger" role="alert">
      <p th:text="${error}"></p>
    </div>

    <!-- formulario de lista -->
    <form th:action="${lista.id == null ? '/listas/crear' : '/listas/' + lista.id + '/editar'}" th:object="${lista}"
      method="post" class="watchlist-form">

      <!-- campo oculto para ID (en edición) -->
      <input type="hidden" th:field="*{id}" />

      <!-- campo título de la lista -->
      <div class="form-group">
        <label for="titulo">Título de la Lista:</label>
        <input type="text" id="titulo" th:field="*{titulo}" class="form-control" required />
        <!-- error de validación del título -->
        <div th:if="${#fields.hasErrors('titulo')}" th:errors="*{titulo}" class="text-danger">
          Error en el título
        </div>
      </div>

      <!-- opción de visibilidad pública -->
      <div class="form-group" style="display: flex; gap: 10px;">
        <label for="esPublica" class="form-check-label">¿Hacer esta lista pública? </label>
        <input type="checkbox" id="esPublica" th:field="*{esPublica}" class="form-check-input" />
      </div>

      <!-- botones de acción del formulario -->
      <div class="form-actions">
        <button type="submit" class="btn btn-small btn-green">
          <span th:text="${lista.id == null ? 'Crear Lista' : 'Guardar Cambios'}">Crear Lista</span>
        </button>
        <a th:href="@{/listas(filtro='mis-listas')}" class="btn btn-small btn-red">Cancelar</a>
      </div>
    </form>
  </section>

  <!-- scripts específicos de la página -->
  <th:block th:fragment="pageScript"></th:block>
</body>

</html>
