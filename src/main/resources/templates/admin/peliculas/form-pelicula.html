<!DOCTYPE html>
<html
  lang="es"
  xmlns:th="http://www.thymeleaf.org"
  th:replace="~{_layout :: html(~{::title}, ~{::section}, ~{::pageCss}, ~{::pageScript})}">
  <head>
    <title th:text="${pageTitle ?: 'Formulario de Película'}">
      Formulario de Película - WatchList
    </title>
    <th:block th:fragment="pageCss"> </th:block>
  </head>
  <body>
    <section>
      <div>
        <h2 th:text="${pageTitle ?: 'Formulario de Película'}">
          Formulario de Película
        </h2>

        <div th:if="${successMessage}" th:text="${successMessage}"></div>
        <div th:if="${errorMessage}" th:text="${errorMessage}"></div>

        <form th:action="${formAction}" th:object="${pelicula}" method="post">
          <div>
            <label for="titulo">Título:</label>
            <input type="text" id="titulo" th:field="*{titulo}" />
            <div
              th:if="${#fields.hasErrors('titulo')}"
              th:errors="*{titulo}"></div>
          </div>

          <div>
            <label for="sinopsis">Sinopsis:</label>
            <textarea id="sinopsis" th:field="*{sinopsis}"></textarea>
            <div
              th:if="${#fields.hasErrors('sinopsis')}"
              th:errors="*{sinopsis}"></div>
          </div>

          <div>
            <label for="anioEstreno">Año de Estreno:</label>
            <input type="number" id="anioEstreno" th:field="*{anioEstreno}" />
            <div
              th:if="${#fields.hasErrors('anioEstreno')}"
              th:errors="*{anioEstreno}"></div>
          </div>

          <div>
            <label for="puntuacion">Puntuación (0-10):</label>
            <input
              type="number"
              step="0.1"
              id="puntuacion"
              th:field="*{puntuacion}" />
            <div
              th:if="${#fields.hasErrors('puntuacion')}"
              th:errors="*{puntuacion}"></div>
          </div>

          <div>
            <label for="urlTrailer"
              >URL del Trailer (YouTube, Vimeo, etc.):</label
            >
            <input
              type="url"
              id="urlTrailer"
              th:field="*{urlTrailer}"
              placeholder="https://www.youtube.com/watch?v=example" />
            <div
              th:if="${#fields.hasErrors('urlTrailer')}"
              th:errors="*{urlTrailer}"></div>
          </div>

          <div>
            <label for="urlImagen">URL de la Imagen/Póster:</label>
            <input
              type="url"
              id="urlImagen"
              th:field="*{urlImagen}"
              placeholder="https://example.com/poster.jpg" />
            <div
              th:if="${#fields.hasErrors('urlImagen')}"
              th:errors="*{urlImagen}"></div>
          </div>

          <div>
            <label for="duracionMin">Duración (minutos):</label>
            <input type="number" id="duracionMin" th:field="*{duracionMin}" />
            <div
              th:if="${#fields.hasErrors('duracionMin')}"
              th:errors="*{duracionMin}"></div>
          </div>
          
          <div>
            <label for="generoIds">Géneros:</label>
            <select
              multiple="multiple"
              id="generoIds"
              name="generoIds">
              <option
                th:each="genero : ${allGeneros}"
                th:value="${genero.id}"
                th:text="${genero.nombre}"
                th:selected="${pelicula.generos != null && pelicula.generos.contains(genero)}"></option>
            </select>
          </div>

          <div>
            <label for="plataformaIds">Plataformas:</label>
            <select multiple="multiple" id="plataformaIds" name="plataformaIds">
              <option
                th:each="plataforma : ${allPlataformas}"
                th:value="${plataforma.id}"
                th:text="${plataforma.nombre}"
                th:selected="${pelicula.plataformas != null && pelicula.plataformas.contains(plataforma)}"></option>
            </select>
          </div>

          <div>
            <label for="personaIds">Personas (Actores/Directores):</label>
            <select multiple="multiple" id="personaIds" name="personaIds">
              <option
                th:each="persona : ${allPersonas}"
                th:value="${persona.id}"
                th:text="${persona.nombre}"
                th:selected="${pelicula.personas != null && pelicula.personas.contains(persona)}"></option>
            </select>
          </div>

          <div>
            <button type="submit" class="btn btn-small btn-yellow">
              Guardar Película
            </button>
            <a th:href="@{/admin/peliculas}" class="btn btn-small btn-red"
              >Cancelar</a
            >
          </div>
        </form>
      </div>
    </section>
    <th:block th:fragment="pageScript">
      <script>
      </script>
    </th:block>
  </body>
</html>
